{"version":3,"file":"index.js","sources":["../src/SVGContextService.ts","../src/ContextRegisterPlugin.ts","../src/index.ts"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { createSVGElement } from '@antv/g-plugin-svg-renderer';\nimport { isString } from '@antv/util';\nvar SVGContextService = /** @class */ (function () {\n    function SVGContextService(context) {\n        this.canvasConfig = context.config;\n    }\n    SVGContextService.prototype.init = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, container, doc, $namespace, dpr;\n            return __generator(this, function (_b) {\n                _a = this.canvasConfig, container = _a.container, doc = _a.document;\n                // create container\n                this.$container = isString(container) ? (doc || document).getElementById(container) : container;\n                if (this.$container) {\n                    if (!this.$container.style.position) {\n                        this.$container.style.position = 'relative';\n                    }\n                    $namespace = createSVGElement('svg', doc);\n                    $namespace.setAttribute('width', \"\".concat(this.canvasConfig.width));\n                    $namespace.setAttribute('height', \"\".concat(this.canvasConfig.height));\n                    this.$container.appendChild($namespace);\n                    this.$namespace = $namespace;\n                }\n                dpr = window.devicePixelRatio || 1;\n                dpr = dpr >= 1 ? Math.ceil(dpr) : 1;\n                this.dpr = dpr;\n                return [2 /*return*/];\n            });\n        });\n    };\n    // @ts-ignore\n    SVGContextService.prototype.getDomElement = function () {\n        return this.$namespace;\n    };\n    SVGContextService.prototype.getContext = function () {\n        return this.$namespace;\n    };\n    SVGContextService.prototype.getDPR = function () {\n        return this.dpr;\n    };\n    SVGContextService.prototype.getBoundingClientRect = function () {\n        var _a;\n        return (_a = this.$namespace) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect();\n    };\n    SVGContextService.prototype.destroy = function () {\n        // destroy context\n        if (this.$container && this.$namespace && this.$namespace.parentNode) {\n            this.$container.removeChild(this.$namespace);\n        }\n    };\n    SVGContextService.prototype.resize = function (width, height) {\n        if (this.$namespace) {\n            this.$namespace.setAttribute('width', \"\".concat(width));\n            this.$namespace.setAttribute('height', \"\".concat(height));\n        }\n    };\n    SVGContextService.prototype.applyCursorStyle = function (cursor) {\n        if (this.$container) {\n            this.$container.style.cursor = cursor;\n        }\n    };\n    SVGContextService.prototype.toDataURL = function (options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var cloneNode, svgDocType, svgDoc;\n            return __generator(this, function (_a) {\n                cloneNode = this.$namespace.cloneNode(true);\n                svgDocType = document.implementation.createDocumentType('svg', '-//W3C//DTD SVG 1.1//EN', 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd');\n                svgDoc = document.implementation.createDocument('http://www.w3.org/2000/svg', 'svg', svgDocType);\n                svgDoc.replaceChild(cloneNode, svgDoc.documentElement);\n                return [2 /*return*/, \"data:image/svg+xml;charset=utf8,\".concat(encodeURIComponent(new XMLSerializer().serializeToString(svgDoc)))];\n            });\n        });\n    };\n    return SVGContextService;\n}());\nexport { SVGContextService };\n//# sourceMappingURL=SVGContextService.js.map","import { __extends } from \"tslib\";\nimport { AbstractRendererPlugin } from '@antv/g-lite';\nimport { SVGContextService } from './SVGContextService';\nvar ContextRegisterPlugin = /** @class */ (function (_super) {\n    __extends(ContextRegisterPlugin, _super);\n    function ContextRegisterPlugin() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.name = 'mobile-svg-context-register';\n        return _this;\n    }\n    ContextRegisterPlugin.prototype.init = function () {\n        // @ts-ignore\n        this.context.ContextService = SVGContextService;\n    };\n    ContextRegisterPlugin.prototype.destroy = function () {\n        delete this.context.ContextService;\n    };\n    return ContextRegisterPlugin;\n}(AbstractRendererPlugin));\nexport { ContextRegisterPlugin };\n//# sourceMappingURL=ContextRegisterPlugin.js.map","import { __extends } from \"tslib\";\nimport { AbstractRenderer } from '@antv/g-lite';\nimport * as DragDropEvent from '@antv/g-plugin-dragndrop';\nimport * as MobileInteraction from '@antv/g-plugin-mobile-interaction';\nimport * as SVGPicker from '@antv/g-plugin-svg-picker';\nimport * as SVGRenderer from '@antv/g-plugin-svg-renderer';\nimport * as GesturePlugin from '@antv/g-plugin-gesture';\nimport { isNil } from '@antv/util';\nimport { ContextRegisterPlugin } from './ContextRegisterPlugin';\nexport { MobileInteraction, SVGRenderer, SVGPicker };\nvar Renderer = /** @class */ (function (_super) {\n    __extends(Renderer, _super);\n    function Renderer(config) {\n        var _this = _super.call(this, config) || this;\n        _this.registerPlugin(new ContextRegisterPlugin());\n        _this.registerPlugin(new SVGRenderer.Plugin());\n        _this.registerPlugin(new MobileInteraction.Plugin());\n        _this.registerPlugin(new SVGPicker.Plugin());\n        _this.registerPlugin(new DragDropEvent.Plugin({\n            isDocumentDraggable: isNil(config === null || config === void 0 ? void 0 : config.isDocumentDraggable)\n                ? true\n                : config.isDocumentDraggable,\n            isDocumentDroppable: isNil(config === null || config === void 0 ? void 0 : config.isDocumentDroppable)\n                ? true\n                : config.isDocumentDroppable,\n            dragstartDistanceThreshold: isNil(config === null || config === void 0 ? void 0 : config.dragstartDistanceThreshold)\n                ? 10\n                : config.dragstartDistanceThreshold,\n            dragstartTimeThreshold: isNil(config === null || config === void 0 ? void 0 : config.dragstartTimeThreshold)\n                ? 50\n                : config.dragstartTimeThreshold,\n        }));\n        _this.registerPlugin(new GesturePlugin.Plugin({\n            isDocumentGestureEnabled: true,\n        }));\n        return _this;\n    }\n    return Renderer;\n}(AbstractRenderer));\nexport { Renderer };\n//# sourceMappingURL=index.js.map"],"names":["__awaiter","__generator","isString","createSVGElement","__extends","AbstractRendererPlugin","SVGRenderer","MobileInteraction","SVGPicker","DragDropEvent","isNil","GesturePlugin","AbstractRenderer"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,IAAI,iBAAiB,kBAAkB,YAAY;AACnD,IAAI,SAAS,iBAAiB,CAAC,OAAO,EAAE;AACxC,QAAQ,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC,MAAM,CAAC;AAC3C,KAAK;AACL,IAAI,iBAAiB,CAAC,SAAS,CAAC,IAAI,GAAG,YAAY;AACnD,QAAQ,OAAOA,eAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;AAC3D,YAAY,IAAI,EAAE,EAAE,SAAS,EAAE,GAAG,EAAE,UAAU,EAAE,GAAG,CAAC;AACpD,YAAY,OAAOC,iBAAW,CAAC,IAAI,EAAE,UAAU,EAAE,EAAE;AACnD,gBAAgB,EAAE,GAAG,IAAI,CAAC,YAAY,EAAE,SAAS,GAAG,EAAE,CAAC,SAAS,EAAE,GAAG,GAAG,EAAE,CAAC,QAAQ,CAAC;AACpF;AACA,gBAAgB,IAAI,CAAC,UAAU,GAAGC,aAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,IAAI,QAAQ,EAAE,cAAc,CAAC,SAAS,CAAC,GAAG,SAAS,CAAC;AAChH,gBAAgB,IAAI,IAAI,CAAC,UAAU,EAAE;AACrC,oBAAoB,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,QAAQ,EAAE;AACzD,wBAAwB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;AACpE,qBAAqB;AACrB,oBAAoB,UAAU,GAAGC,4BAAgB,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;AAC9D,oBAAoB,UAAU,CAAC,YAAY,CAAC,OAAO,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;AACzF,oBAAoB,UAAU,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC;AAC3F,oBAAoB,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;AAC5D,oBAAoB,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;AACjD,iBAAiB;AACjB,gBAAgB,GAAG,GAAG,MAAM,CAAC,gBAAgB,IAAI,CAAC,CAAC;AACnD,gBAAgB,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACpD,gBAAgB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;AAC/B,gBAAgB,OAAO,CAAC,CAAC,YAAY,CAAC;AACtC,aAAa,CAAC,CAAC;AACf,SAAS,CAAC,CAAC;AACX,KAAK,CAAC;AACN;AACA,IAAI,iBAAiB,CAAC,SAAS,CAAC,aAAa,GAAG,YAAY;AAC5D,QAAQ,OAAO,IAAI,CAAC,UAAU,CAAC;AAC/B,KAAK,CAAC;AACN,IAAI,iBAAiB,CAAC,SAAS,CAAC,UAAU,GAAG,YAAY;AACzD,QAAQ,OAAO,IAAI,CAAC,UAAU,CAAC;AAC/B,KAAK,CAAC;AACN,IAAI,iBAAiB,CAAC,SAAS,CAAC,MAAM,GAAG,YAAY;AACrD,QAAQ,OAAO,IAAI,CAAC,GAAG,CAAC;AACxB,KAAK,CAAC;AACN,IAAI,iBAAiB,CAAC,SAAS,CAAC,qBAAqB,GAAG,YAAY;AACpE,QAAQ,IAAI,EAAE,CAAC;AACf,QAAQ,OAAO,CAAC,EAAE,GAAG,IAAI,CAAC,UAAU,MAAM,IAAI,IAAI,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,qBAAqB,EAAE,CAAC;AACtG,KAAK,CAAC;AACN,IAAI,iBAAiB,CAAC,SAAS,CAAC,OAAO,GAAG,YAAY;AACtD;AACA,QAAQ,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;AAC9E,YAAY,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AACzD,SAAS;AACT,KAAK,CAAC;AACN,IAAI,iBAAiB,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,KAAK,EAAE,MAAM,EAAE;AAClE,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE;AAC7B,YAAY,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,OAAO,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;AACpE,YAAY,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;AACtE,SAAS;AACT,KAAK,CAAC;AACN,IAAI,iBAAiB,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,MAAM,EAAE;AACrE,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE;AAC7B,YAAY,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;AAClD,SAAS;AACT,KAAK,CAAC;AACN,IAAI,iBAAiB,CAAC,SAAS,CAAC,SAAS,GAAG,UAAU,OAAO,EAAE;AAE/D,QAAQ,OAAOH,eAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,YAAY;AAC3D,YAAY,IAAI,SAAS,EAAE,UAAU,EAAE,MAAM,CAAC;AAC9C,YAAY,OAAOC,iBAAW,CAAC,IAAI,EAAE,UAAU,EAAE,EAAE;AACnD,gBAAgB,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;AAC5D,gBAAgB,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,kBAAkB,CAAC,KAAK,EAAE,yBAAyB,EAAE,kDAAkD,CAAC,CAAC;AAC9J,gBAAgB,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,4BAA4B,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;AACjH,gBAAgB,MAAM,CAAC,YAAY,CAAC,SAAS,EAAE,MAAM,CAAC,eAAe,CAAC,CAAC;AACvE,gBAAgB,OAAO,CAAC,CAAC,aAAa,kCAAkC,CAAC,MAAM,CAAC,kBAAkB,CAAC,IAAI,aAAa,EAAE,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;AACpJ,aAAa,CAAC,CAAC;AACf,SAAS,CAAC,CAAC;AACX,KAAK,CAAC;AACN,IAAI,OAAO,iBAAiB,CAAC;AAC7B,CAAC,EAAE,CAAC;;ACzEJ,IAAI,qBAAqB,kBAAkB,UAAU,MAAM,EAAE;AAC7D,IAAIG,eAAS,CAAC,qBAAqB,EAAE,MAAM,CAAC,CAAC;AAC7C,IAAI,SAAS,qBAAqB,GAAG;AACrC,QAAQ,IAAI,KAAK,GAAG,MAAM,KAAK,IAAI,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,IAAI,CAAC;AAC7E,QAAQ,KAAK,CAAC,IAAI,GAAG,6BAA6B,CAAC;AACnD,QAAQ,OAAO,KAAK,CAAC;AACrB,KAAK;AACL,IAAI,qBAAqB,CAAC,SAAS,CAAC,IAAI,GAAG,YAAY;AACvD;AACA,QAAQ,IAAI,CAAC,OAAO,CAAC,cAAc,GAAG,iBAAiB,CAAC;AACxD,KAAK,CAAC;AACN,IAAI,qBAAqB,CAAC,SAAS,CAAC,OAAO,GAAG,YAAY;AAC1D,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC;AAC3C,KAAK,CAAC;AACN,IAAI,OAAO,qBAAqB,CAAC;AACjC,CAAC,CAACC,4BAAsB,CAAC,CAAC;;ACRvB,IAAC,QAAQ,kBAAkB,UAAU,MAAM,EAAE;AAChD,IAAID,eAAS,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AAChC,IAAI,SAAS,QAAQ,CAAC,MAAM,EAAE;AAC9B,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;AACtD,QAAQ,KAAK,CAAC,cAAc,CAAC,IAAI,qBAAqB,EAAE,CAAC,CAAC;AAC1D,QAAQ,KAAK,CAAC,cAAc,CAAC,IAAIE,sBAAW,CAAC,MAAM,EAAE,CAAC,CAAC;AACvD,QAAQ,KAAK,CAAC,cAAc,CAAC,IAAIC,4BAAiB,CAAC,MAAM,EAAE,CAAC,CAAC;AAC7D,QAAQ,KAAK,CAAC,cAAc,CAAC,IAAIC,oBAAS,CAAC,MAAM,EAAE,CAAC,CAAC;AACrD,QAAQ,KAAK,CAAC,cAAc,CAAC,IAAIC,wBAAa,CAAC,MAAM,CAAC;AACtD,YAAY,mBAAmB,EAAEC,UAAK,CAAC,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,MAAM,CAAC,mBAAmB,CAAC;AAClH,kBAAkB,IAAI;AACtB,kBAAkB,MAAM,CAAC,mBAAmB;AAC5C,YAAY,mBAAmB,EAAEA,UAAK,CAAC,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,MAAM,CAAC,mBAAmB,CAAC;AAClH,kBAAkB,IAAI;AACtB,kBAAkB,MAAM,CAAC,mBAAmB;AAC5C,YAAY,0BAA0B,EAAEA,UAAK,CAAC,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,MAAM,CAAC,0BAA0B,CAAC;AAChI,kBAAkB,EAAE;AACpB,kBAAkB,MAAM,CAAC,0BAA0B;AACnD,YAAY,sBAAsB,EAAEA,UAAK,CAAC,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,MAAM,CAAC,sBAAsB,CAAC;AACxH,kBAAkB,EAAE;AACpB,kBAAkB,MAAM,CAAC,sBAAsB;AAC/C,SAAS,CAAC,CAAC,CAAC;AACZ,QAAQ,KAAK,CAAC,cAAc,CAAC,IAAIC,wBAAa,CAAC,MAAM,CAAC;AACtD,YAAY,wBAAwB,EAAE,IAAI;AAC1C,SAAS,CAAC,CAAC,CAAC;AACZ,QAAQ,OAAO,KAAK,CAAC;AACrB,KAAK;AACL,IAAI,OAAO,QAAQ,CAAC;AACpB,CAAC,CAACC,sBAAgB,CAAC;;;;;;;"}